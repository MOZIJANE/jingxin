[INFO]2021-05-11 15:45:00,135: log files at C:\Users\Administrator\Desktop\SVN\branches\common\log
[INFO]2021-05-11 15:45:00,136: find module account.main_account
[INFO]2021-05-11 15:45:00,137: find module agvCtrl.main_agv
[INFO]2021-05-11 15:45:00,138: find module agvDevice.main_agvDevice
[INFO]2021-05-11 15:45:00,139: find module alarm.main_alarm
[INFO]2021-05-11 15:45:00,140: find module auth.main_auth
[INFO]2021-05-11 15:45:00,141: find module door.main_door
[INFO]2021-05-11 15:45:00,141: find module elevator.main_elevator
[INFO]2021-05-11 15:45:00,144: find module feed.main_feed
[INFO]2021-05-11 15:45:00,145: find module menu.main_menu
[INFO]2021-05-11 15:45:00,146: find module pharmapackCtrl.main_scadaCtrl
[INFO]2021-05-11 15:45:00,147: find module webFront.main_web
[INFO]2021-05-11 15:45:00,147: find module wmqtt.main_wmqtt
[INFO]2021-05-11 15:45:00,148: import account.main_account
[INFO]2021-05-11 15:45:00,234: import agvCtrl.main_agv
[INFO]2021-05-11 15:45:00,540: create lock <lock name:doorMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A61CAEB8>>
[INFO]2021-05-11 15:45:00,543: create lock <lock name:door.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A62280A8>>
[INFO]2021-05-11 15:45:00,633: create lock <lock name:timer.lock_2923368475000,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A6529648>>
[ERROR]2021-05-11 15:45:00,645: mqtt is disabled
[INFO]2021-05-11 15:45:00,645: mqtt: subscribe [alarm/raise/+]
[INFO]2021-05-11 15:45:00,646: mqtt: subscribe [alarm/clear/+]
[INFO]2021-05-11 15:45:03,683: Mongodb connect to 127.0.0.1 port 27017
[INFO]2021-05-11 15:45:03,739: create lock <lock name:elevatorApi.tcp_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A693B350>>
[INFO]2021-05-11 15:45:03,741: create lock <lock name:elevatorApi.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A4820F58>>
[INFO]2021-05-11 15:45:03,742: create lock <lock name:elevatorMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A48209E0>>
[INFO]2021-05-11 15:45:03,884: create lock <lock name:mapMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A4B9CDA0>>
[INFO]2021-05-11 15:45:04,135: create lock <lock name:agvList.g_agvLock,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A6A1DEB8>>
[INFO]2021-05-11 15:45:04,140: create lock <lock name:taskList.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A6AB1F08>>
[INFO]2021-05-11 15:45:04,199: charge policy 1 , fix time
[INFO]2021-05-11 15:45:04,231: create lock <lock name:agvApi.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A6AB1BC0>>
[INFO]2021-05-11 15:45:04,617: start load map C:\Users\Administrator\Desktop\SVN\branches\agvCtrl\projects\test\comba-ZSC-F1-F3.smap
[DEBUG]2021-05-11 15:45:04,812: elevator thread start
[INFO]2021-05-11 15:45:04,831: load map C:\Users\Administrator\Desktop\SVN\branches\agvCtrl\projects\test\comba-ZSC-F1-F3.smap ,used 223 ms
[INFO]2021-05-11 15:45:04,841: start load map C:\Users\Administrator\Desktop\SVN\branches\agvCtrl\projects\test\comba-ZXC-3F.smap
[INFO]2021-05-11 15:45:04,915: load map C:\Users\Administrator\Desktop\SVN\branches\agvCtrl\projects\test\comba-ZXC-3F.smap ,used 83 ms
[INFO]2021-05-11 15:45:04,926: start load map C:\Users\Administrator\Desktop\SVN\branches\agvCtrl\projects\test\comba-ZXC-F3.smap
[INFO]2021-05-11 15:45:05,019: load map C:\Users\Administrator\Desktop\SVN\branches\agvCtrl\projects\test\comba-ZXC-F3.smap ,used 102 ms
[INFO]2021-05-11 15:45:05,025: import agvDevice.main_agvDevice
[INFO]2021-05-11 15:45:05,027: import alarm.main_alarm
[INFO]2021-05-11 15:45:05,028: import auth.main_auth
[INFO]2021-05-11 15:45:05,035: import door.main_door
[INFO]2021-05-11 15:45:05,038: import elevator.main_elevator
[INFO]2021-05-11 15:45:05,039: import feed.main_feed
[INFO]2021-05-11 15:45:05,050: create lock <lock name:feedTask.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A6F651C0>>
[INFO]2021-05-11 15:45:05,056: create lock <lock name:agvApi.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A6F805D0>>
[INFO]2021-05-11 15:45:05,131: import menu.main_menu
[INFO]2021-05-11 15:45:05,135: import pharmapackCtrl.main_scadaCtrl
[INFO]2021-05-11 15:45:05,225: create lock <lock name:runTasks.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A7051558>>
[INFO]2021-05-11 15:45:05,228: create lock <lock name:runTasks.pre_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A7051580>>
[INFO]2021-05-11 15:45:05,672: import webFront.main_web
[INFO]2021-05-11 15:45:05,679: import wmqtt.main_wmqtt
[SUCC]2021-05-11 15:45:05,692: utility start, pid=5712, ppid=144
[DEBUG]2021-05-11 15:45:05,693: start timer
[INFO]2021-05-11 15:45:05,706: load agv file: C:\Users\Administrator\Desktop\SVN\branches\agvCtrl/projects/test/agv.cfg
[INFO]2021-05-11 15:45:05,707: create lock <lock name:agvList.AGV02.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A7051800>>
[DEBUG]2021-05-11 15:45:05,709: create aliveObj AGV02 AGV离线异常 timeout 300
[INFO]2021-05-11 15:45:05,710: AGV02 start agvList run thread
[INFO]2021-05-11 15:45:05,710: AGV02 start agvList run2 thread
[INFO]2021-05-11 15:45:05,711: create lock <lock name:agv.AGV02.lock_status,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A7051C38>>
[DEBUG]2021-05-11 15:45:05,712: try connect AGV02 172.16.217.213:19204
[INFO]2021-05-11 15:45:05,713: add_ignore: taskStatus
[INFO]2021-05-11 15:45:05,714: add_ignore: api/elevator/status
[INFO]2021-05-11 15:45:05,714: add_ignore: scada/getTask
[INFO]2021-05-11 15:45:05,719: AGV02 connected 172.16.217.213 19204
[INFO]2021-05-11 15:45:05,723: create lock <lock name:agv.AGV02.lock_ctrl,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A7051D28>>
[DEBUG]2021-05-11 15:45:05,725: try connect AGV02 172.16.217.213:19205
[INFO]2021-05-11 15:45:05,729: AGV02 connected 172.16.217.213 19205
[INFO]2021-05-11 15:45:05,730: create lock <lock name:agv.AGV02.lock_task,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A752C508>>
[DEBUG]2021-05-11 15:45:05,731: try connect AGV02 172.16.217.213:19206
[INFO]2021-05-11 15:45:05,742: AGV02 connected 172.16.217.213 19206
[INFO]2021-05-11 15:45:05,743: create lock <lock name:agv.AGV02.lock_conf,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A752C558>>
[DEBUG]2021-05-11 15:45:05,744: try connect AGV02 172.16.217.213:19207
[INFO]2021-05-11 15:45:05,753: AGV02 connected 172.16.217.213 19207
[INFO]2021-05-11 15:45:05,756: create lock <lock name:agv.AGV02.lock_core,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A752C580>>
[DEBUG]2021-05-11 15:45:05,757: try connect AGV02 172.16.217.213:19208
[INFO]2021-05-11 15:45:05,762: AGV02 connected 172.16.217.213 19208
[INFO]2021-05-11 15:45:05,763: create lock <lock name:agv.AGV02.lock_other,<unlocked _thread.RLock object owner=0 count=0 at 0x000002A8A752C5A8>>
[DEBUG]2021-05-11 15:45:05,766: try connect AGV02 172.16.217.213:19210
[INFO]2021-05-11 15:45:05,775: AGV02 connected 172.16.217.213 19210
[INFO]2021-05-11 15:45:05,797: AGV02 current map comba-ZSC-F1-F3
[INFO]2021-05-11 15:45:05,813: AGV02 is online
[WARNING]2021-05-11 15:45:05,824: clear alarm obj=AGV02, typeId=54231, id=609a3300374a0b76c548355e
[WARNING]2021-05-11 15:45:05,828: clear alarm obj=AGV02, typeId=52106, id=609a350a374a0b76c54837b7
[WARNING]2021-05-11 15:45:05,832: clear alarm obj=AGV02, typeId=52111, id=609a350a374a0b76c54837b9
[WARNING]2021-05-11 15:45:05,835: clear alarm obj=AGV02, typeId=52705, id=609a350a374a0b76c54837bb
[DEBUG]2021-05-11 15:45:07,708: GET: http://127.0.0.1:5551/api/agv/init?appName=scadaTask addr: 127.0.0.1
[INFO]2021-05-11 15:45:07,711: scadaTask init client agvApi
[DEBUG]2021-05-11 15:45:07,715: used 7ms 200 OK application/json;charset=utf-8, GET: http://127.0.0.1:5551/api/agv/init?appName=scadaTask
[DEBUG]2021-05-11 15:45:10,811: GET: http://127.0.0.1:5551/api/agv/startCharge?appName=scadaTask addr: 127.0.0.1
[DEBUG]2021-05-11 15:45:10,889: used 78ms 200 OK application/json;charset=utf-8, GET: http://127.0.0.1:5551/api/agv/startCharge?appName=scadaTask
[WARNING]2021-05-11 15:45:11,222: timer_thread[tid:14284] <lock name:runTasks.g_lock,<locked _thread.RLock object owner=14284 count=1 at 0x000002A8A7051558>> ,hold 3518 ms
[INFO]2021-05-11 15:45:11,485: name=timer_thread, pid=5712, tid=14284
[01] File "C:/Python37/lib/threading.py", line 865, in run() 
[02] File "C:/Users/Administrator/Desktop/SVN/branches/common/mytimer.py", line 113, in _loop() 
[03] File "C:/Users/Administrator/Desktop/SVN/branches/common/lock.py", line 122, in _call() 
[04] File "C:/Users/Administrator/Desktop/SVN/branches/common/lock.py", line 100, in release() 
[05] File "C:/Users/Administrator/Desktop/SVN/branches/common/enhance.py", line 258, in getTrace() 
[06] File "C:/Users/Administrator/Desktop/SVN/branches/common/enhance.py", line 240, in getThreadStack()
[DEBUG]2021-05-11 15:45:23,077: GET: http://127.0.0.1:5551/api/scada/addTask?source=%E4%B8%80%E6%A5%BC%E4%BB%93%E5%BA%93%E4%B8%8A%E6%96%99B&target=%E4%B8%80%E6%A5%BC%E4%BB%93%E5%BA%93%E4%B8%8A%E6%96%99B addr: 127.0.0.1
[INFO]2021-05-11 15:45:23,140: Scada send a task to the server from 一楼仓库上料B to 一楼仓库上料B payloadId: None
[INFO]2021-05-11 15:45:23,331: create task[609a36130f25bdaec1ae3059]: type= scadaTask , 从一楼仓库上料B运送货架到一楼仓库上料B {'source': '一楼仓库上料B', 'target': '一楼仓库上料B', 'payloadId': None, 'priority': 1, 'type': 'scadaTask', 'taskName': '从一楼仓库上料B运送货架到一楼仓库上料B', 'createTime': datetime.datetime(2021, 5, 11, 15, 45, 23, 252038), 'updateTime': datetime.datetime(2021, 5, 11, 15, 45, 23, 252038), 'startTime': None, 'endTime': None, 'status': 'waiting', 'step': 'waiting', 'failMsg': None, 'history': [], '_id': ObjectId('609a36130f25bdaec1ae3059')}
[INFO]2021-05-11 15:45:23,378: 
[INFO]2021-05-11 15:45:23,472: 一楼仓库上料B 一楼仓库上料B
[WARNING]2021-05-11 15:45:23,677: task[609a36130f25bdaec1ae3059]: failed, {'failMsg': "can't find target-一楼仓库上料B info", 'endTime': datetime.datetime(2021, 5, 11, 15, 45, 23, 629626), 'status': 'fail'}
[DEBUG]2021-05-11 15:45:23,837: used 760ms 200 OK application/json;charset=utf-8, GET: http://127.0.0.1:5551/api/scada/addTask?source=%E4%B8%80%E6%A5%BC%E4%BB%93%E5%BA%93%E4%B8%8A%E6%96%99B&target=%E4%B8%80%E6%A5%BC%E4%BB%93%E5%BA%93%E4%B8%8A%E6%96%99B
[INFO]2021-05-11 15:45:23,883: task[609a36130f25bdaec1ae3059]:  start {'failMsg': '任务等待执行', 'startTime': datetime.datetime(2021, 5, 11, 15, 45, 23, 852032), 'updateTime': datetime.datetime(2021, 5, 11, 15, 45, 23, 852032), 'status': 'running'}
[DEBUG]2021-05-11 15:45:23,929: GET: http://127.0.0.1:5551/favicon.ico addr: 127.0.0.1
[INFO]2021-05-11 15:45:23,992: this is taskStep=============>waiting
[INFO]2021-05-11 15:45:24,137: task[609a36130f25bdaec1ae3059] update info: {'failMsg': '等待分配小车', 'updateTime': datetime.datetime(2021, 5, 11, 15, 45, 24, 104430)}
[DEBUG]2021-05-11 15:45:24,138: used 209ms 200 OK , GET: http://127.0.0.1:5551/favicon.ico
[CRITICAL]2021-05-11 15:45:24,199: invoke <function scadaTask._taskFunc at 0x000002A8A733B840> cause a error: 'NoneType' object is not subscriptable
pid=5712, ppid=144, tid=13328
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\SVN\branches\pharmapackCtrl\runTasks.py", line 740, in _taskFunc
    log.debug(str(self),old,"->",self.taskStep)
  File "C:\Users\Administrator\Desktop\SVN\branches\pharmapackCtrl\runTasks.py", line 300, in __str__
    s = "task[%s][%s] %s(%s) -> %s(%s) [%s]"%(self.taskId,a,self.s_info["location"],self.s_info["prepoint"],self.t_info["location"],self.t_info["prepoint"],self.taskStep)
TypeError: 'NoneType' object is not subscriptable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\SVN\branches\common\utility.py", line 167, in __call
    return func(*p,**pp)
  File "C:\Users\Administrator\Desktop\SVN\branches\pharmapackCtrl\runTasks.py", line 746, in _taskFunc
    log.exception("taskFunc2:"+str(self),e)
  File "C:\Users\Administrator\Desktop\SVN\branches\pharmapackCtrl\runTasks.py", line 300, in __str__
    s = "task[%s][%s] %s(%s) -> %s(%s) [%s]"%(self.taskId,a,self.s_info["location"],self.s_info["prepoint"],self.t_info["location"],self.t_info["prepoint"],self.taskStep)
TypeError: 'NoneType' object is not subscriptable

[DEBUG]2021-05-11 15:45:55,176: GET: http://127.0.0.1:5551/api/scada/addTask?source=%E4%B8%80%E6%A5%BC%E4%BB%93%E5%BA%93%E4%B8%8A%E6%96%99B&target=%E4%B8%80%E6%A5%BC%E4%BB%93%E5%BA%93%E4%B8%8A%E6%96%99B addr: 127.0.0.1
