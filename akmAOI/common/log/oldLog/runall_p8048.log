[INFO]2021-03-04 11:18:51,177: log files at D:\python_lx\akm\common\log
[INFO]2021-03-04 11:18:51,177: find module agvCtrl.main_agv
[INFO]2021-03-04 11:18:51,177: find module agvDevice.main_agvDevice
[INFO]2021-03-04 11:18:51,177: find module alarm.main_alarm
[INFO]2021-03-04 11:18:51,178: find module auth.main_auth
[INFO]2021-03-04 11:18:51,178: find module button.main_button
[INFO]2021-03-04 11:18:51,178: find module door.main_door
[INFO]2021-03-04 11:18:51,178: find module elevator.main_elevator
[INFO]2021-03-04 11:18:51,178: find module virtualDoor.main_doorCtrl
[INFO]2021-03-04 11:18:51,179: import agvCtrl.main_agv
[INFO]2021-03-04 11:18:51,640: create lock <lock name:doorMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E6FDFD660>>
[INFO]2021-03-04 11:18:51,642: create lock <lock name:door.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E6FE0D840>>
[INFO]2021-03-04 11:18:51,642: create lock <lock name:door.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E6FE0DB10>>
[INFO]2021-03-04 11:18:51,718: create lock <lock name:timer.lock_1642557886576,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E701451B0>>
[ERROR]2021-03-04 11:18:51,727: mqtt is disabled
[INFO]2021-03-04 11:18:51,727: mqtt: subscribe [alarm/raise/+]
[INFO]2021-03-04 11:18:51,727: mqtt: subscribe [alarm/clear/+]
[INFO]2021-03-04 11:18:54,752: Mongodb connect to 127.0.0.1 port 27017
[INFO]2021-03-04 11:18:54,814: create lock <lock name:elevatorApi.tcp_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E703C75A0>>
[INFO]2021-03-04 11:18:54,815: create lock <lock name:elevatorApi.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E703BFEA0>>
[INFO]2021-03-04 11:18:54,816: create lock <lock name:elevatorMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E703BF300>>
[INFO]2021-03-04 11:18:54,852: create lock <lock name:agvserver,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E7040A6C0>>
[INFO]2021-03-04 11:18:55,217: create lock <lock name:mapMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E703D13C0>>
[INFO]2021-03-04 11:18:55,584: create lock <lock name:agvList.g_agvLock,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E704B20C0>>
[INFO]2021-03-04 11:18:55,586: create lock <lock name:taskList.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E70560A50>>
[INFO]2021-03-04 11:18:55,639: charge policy 0 , fix time
[INFO]2021-03-04 11:18:55,666: create lock <lock name:agvApi.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E7056C660>>
[INFO]2021-03-04 11:18:56,106: start load map D:\python_lx\akm\agvCtrl\projects\akm\AKM-AOI.smap
[DEBUG]2021-03-04 11:18:56,262: elevator thread start
[INFO]2021-03-04 11:18:56,282: load map D:\python_lx\akm\agvCtrl\projects\akm\AKM-AOI.smap ,used 185 ms
[INFO]2021-03-04 11:18:56,297: start load map D:\python_lx\akm\agvCtrl\projects\akm\AKM-DC.smap
[INFO]2021-03-04 11:18:56,373: load map D:\python_lx\akm\agvCtrl\projects\akm\AKM-DC.smap ,used 91 ms
[INFO]2021-03-04 11:18:56,393: start load map D:\python_lx\akm\agvCtrl\projects\akm\AKM-DDT.smap
[INFO]2021-03-04 11:18:56,502: load map D:\python_lx\akm\agvCtrl\projects\akm\AKM-DDT.smap ,used 129 ms
[INFO]2021-03-04 11:18:56,509: start load map D:\python_lx\akm\agvCtrl\projects\akm\AKM-FQC.smap
[DEBUG]2021-03-04 11:18:56,672: create aliveObj SK_DOOR 门控离线异常 timeout 60
[DEBUG]2021-03-04 11:18:56,672: create aliveObj vitualDoor01 门控离线异常 timeout 60
[DEBUG]2021-03-04 11:18:56,672: create aliveObj vitualDoor02 门控离线异常 timeout 60
[INFO]2021-03-04 11:18:56,705: load map D:\python_lx\akm\agvCtrl\projects\akm\AKM-FQC.smap ,used 203 ms
[INFO]2021-03-04 11:18:56,715: start load map D:\python_lx\akm\agvCtrl\projects\akm\AKM-LYH.smap
[INFO]2021-03-04 11:18:56,801: load map D:\python_lx\akm\agvCtrl\projects\akm\AKM-LYH.smap ,used 96 ms
[INFO]2021-03-04 11:18:56,809: start load map D:\python_lx\akm\agvCtrl\projects\akm\AKM-ZP.smap
[INFO]2021-03-04 11:18:56,918: load map D:\python_lx\akm\agvCtrl\projects\akm\AKM-ZP.smap ,used 116 ms
[INFO]2021-03-04 11:18:56,929: start load map D:\python_lx\akm\agvCtrl\projects\akm\office.smap
[INFO]2021-03-04 11:18:56,977: load map D:\python_lx\akm\agvCtrl\projects\akm\office.smap ,used 59 ms
[INFO]2021-03-04 11:18:56,980: import agvDevice.main_agvDevice
[INFO]2021-03-04 11:18:56,980: import alarm.main_alarm
[INFO]2021-03-04 11:18:56,980: import auth.main_auth
[INFO]2021-03-04 11:18:56,989: import button.main_button
[INFO]2021-03-04 11:18:56,992: create lock <lock name:agvApi.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E70A81D50>>
[INFO]2021-03-04 11:18:57,044: import door.main_door
[INFO]2021-03-04 11:18:57,048: import elevator.main_elevator
[INFO]2021-03-04 11:18:57,049: import virtualDoor.main_doorCtrl
[INFO]2021-03-04 11:18:59,503: create lock <lock name:IOAlarm.s_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E70AD38D0>>
[DEBUG]2021-03-04 11:18:59,504: create aliveObj magneticAGV01 磁导车掉线异常 timeout 120
[DEBUG]2021-03-04 11:18:59,513: create aliveObj magneticAGV02 磁导车掉线异常 timeout 120
[INFO]2021-03-04 11:18:59,515: create lock <lock name:magneticAGVlarm.s_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E70AD35D0>>
[SUCC]2021-03-04 11:18:59,521: utility start, pid=8048, ppid=8904
[DEBUG]2021-03-04 11:18:59,524: start timer
[INFO]2021-03-04 11:18:59,532: load agv file: D:\python_lx\akm\agvCtrl/projects/akm/agv.cfg
[INFO]2021-03-04 11:18:59,533: create lock <lock name:agvList.AGV23.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E785E57E0>>
[DEBUG]2021-03-04 11:18:59,534: create aliveObj AGV23 AGV离线异常 timeout 300
[INFO]2021-03-04 11:18:59,536: AGV23 start agvList run thread
[INFO]2021-03-04 11:18:59,536: create lock <lock name:agv.AGV23.lock_status,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E786042A0>>
[INFO]2021-03-04 11:18:59,536: AGV23 start agvList run2 thread
[DEBUG]2021-03-04 11:18:59,536: try connect AGV23 192.168.20.198:19204
[WARN]2021-03-04 11:18:59,539: Local server start! version 3.8.0, path D:\python_lx\akm\common, pid 8048
[INFO]2021-03-04 11:18:59,539: add_ignore: taskStatus
[WARN]2021-03-04 11:19:02,578: clear alarm obj=SK_DOOR, typeId=39998, id=6040496d55e736c96cc0091a
[INFO]2021-03-04 11:19:03,414: AGV23 connected 192.168.20.198 19204
[WARN]2021-03-04 11:19:03,415: agvThread.AGV23[tid:880] <lock name:agv.AGV23.lock_status,<locked _thread.RLock object owner=880 count=1 at 0x0000017E786042A0>> ,hold 3879 ms
[INFO]2021-03-04 11:19:03,418: name=agvThread.AGV23, pid=8048, tid=880
[01] File "C:/Python38/lib/threading.py", line 870, in run() 
[02] File "D:/python_lx/akm/agvCtrl/agvList.py", line 565, in run() 
[03] File "D:/python_lx/akm/driver/seerAgv/agvCtrl.py", line 36, in checkLink() 
[04] File "D:/python_lx/akm/driver/seerAgv/agvApi.py", line 184, in checkLink() 
[05] File "D:/python_lx/akm/common/lock.py", line 102, in release() 
[06] File "D:/python_lx/akm/common/enhance.py", line 268, in getTrace() 
[07] File "D:/python_lx/akm/common/enhance.py", line 248, in getThreadStack()
[INFO]2021-03-04 11:19:03,418: create lock <lock name:agv.AGV23.lock_ctrl,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E786042D0>>
[DEBUG]2021-03-04 11:19:03,419: try connect AGV23 192.168.20.198:19205
[WARN]2021-03-04 11:19:03,455: clear alarm obj=magneticAGV01, typeId=39998, id=604049ad55e736c96cc0094c
[INFO]2021-03-04 11:19:03,508: AGV23 connected 192.168.20.198 19205
[INFO]2021-03-04 11:19:03,510: create lock <lock name:agv.AGV23.lock_task,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E78604300>>
[DEBUG]2021-03-04 11:19:03,511: try connect AGV23 192.168.20.198:19206
[INFO]2021-03-04 11:19:03,600: AGV23 connected 192.168.20.198 19206
[INFO]2021-03-04 11:19:03,601: create lock <lock name:agv.AGV23.lock_conf,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E78604420>>
[DEBUG]2021-03-04 11:19:03,602: try connect AGV23 192.168.20.198:19207
[INFO]2021-03-04 11:19:03,609: AGV23 connected 192.168.20.198 19207
[INFO]2021-03-04 11:19:03,610: create lock <lock name:agv.AGV23.lock_core,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E7ACBD9C0>>
[DEBUG]2021-03-04 11:19:03,611: try connect AGV23 192.168.20.198:19208
[INFO]2021-03-04 11:19:03,628: AGV23 connected 192.168.20.198 19208
[INFO]2021-03-04 11:19:03,629: create lock <lock name:agv.AGV23.lock_other,<unlocked _thread.RLock object owner=0 count=0 at 0x0000017E778E2F90>>
[DEBUG]2021-03-04 11:19:03,630: try connect AGV23 192.168.20.198:19210
[INFO]2021-03-04 11:19:03,648: AGV23 connected 192.168.20.198 19210
[INFO]2021-03-04 11:19:03,803: AGV23 current map AKM-FQC
[INFO]2021-03-04 11:19:03,959: AGV23 is online
[INFO]2021-03-04 11:19:07,616: startCharge is false
[CRITICAL]2021-03-04 11:19:10,641: invoke timer func<function _loadDevicesAlarm at 0x0000017E785E73A0> cause a error: name 'db' is not defined
pid=8048, ppid=8904, tid=12768
Traceback (most recent call last):
  File "D:\python_lx\akm\common\mytimer.py", line 113, in _loop
    v.func(*v.args)
  File "D:\python_lx\akm\virtualDoor\doorCtrlRunTasks.py", line 119, in _loadDevicesAlarm
    ds = db.find("r_alarm", { "typeId": {"$in":[39998]}, "domain": "agv"})
NameError: name 'db' is not defined

