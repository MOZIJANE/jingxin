[INFO]2021-06-15 09:44:47,742: log files at C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\common\log
[INFO]2021-06-15 09:44:47,743: find module account.main_account
[INFO]2021-06-15 09:44:47,743: find module agvCtrl.main_agv
[INFO]2021-06-15 09:44:47,743: find module agvDevice.main_agvDevice
[INFO]2021-06-15 09:44:47,744: find module akmCtrl.main_akmCtrl
[INFO]2021-06-15 09:44:47,744: find module alarm.main_alarm
[INFO]2021-06-15 09:44:47,744: find module auth.main_auth
[INFO]2021-06-15 09:44:47,745: find module door.main_door
[INFO]2021-06-15 09:44:47,745: find module elevator.main_elevator
[INFO]2021-06-15 09:44:47,746: find module feed.main_feed
[INFO]2021-06-15 09:44:47,746: find module remoteio.main_remoteio
[INFO]2021-06-15 09:44:47,746: import account.main_account
[INFO]2021-06-15 09:44:47,824: import agvCtrl.main_agv
[INFO]2021-06-15 09:44:48,108: create lock <lock name:doorMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001F90E0AEDA0>>
[INFO]2021-06-15 09:44:48,124: create lock <lock name:door.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001F90E0AEF08>>
[INFO]2021-06-15 09:44:48,211: create lock <lock name:timer.lock_2169198105320,<unlocked _thread.RLock object owner=0 count=0 at 0x000001F90E425B98>>
[ERROR]2021-06-15 09:44:48,224: mqtt is disabled
[INFO]2021-06-15 09:44:48,224: mqtt: subscribe [alarm/raise/+]
[INFO]2021-06-15 09:44:48,225: mqtt: subscribe [alarm/clear/+]
[INFO]2021-06-15 09:44:51,268: Mongodb connect to 127.0.0.1 port 27017
[INFO]2021-06-15 09:44:51,296: create lock <lock name:elevatorMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001F90E6E7058>>
[WARNING]2021-06-15 09:44:51,312: use mockAgvCtrl
[INFO]2021-06-15 09:44:51,316: create lock <lock name:mapMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001F90D0EDC88>>
[INFO]2021-06-15 09:44:51,591: create lock <lock name:agvList.g_agvLock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001F90E79A0A8>>
[INFO]2021-06-15 09:44:51,596: create lock <lock name:taskList.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001F90E79AF08>>
[INFO]2021-06-15 09:44:51,658: charge policy 1 , fix time
[INFO]2021-06-15 09:44:51,695: create lock <lock name:agvApi.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001F90E812080>>
[INFO]2021-06-15 09:44:52,302: start load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\AKM2F.smap
[DEBUG]2021-06-15 09:44:52,400: elevator thread start
[INFO]2021-06-15 09:44:52,420: load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\AKM2F.smap ,used 126 ms
[INFO]2021-06-15 09:44:52,431: start load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\akmsmt.smap
[INFO]2021-06-15 09:44:52,479: load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\akmsmt.smap ,used 58 ms
[INFO]2021-06-15 09:44:52,489: start load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\akmsmtMap.smap
[INFO]2021-06-15 09:44:52,616: load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\akmsmtMap.smap ,used 136 ms
[INFO]2021-06-15 09:44:52,627: start load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\desai-all-20191223.smap
[INFO]2021-06-15 09:44:52,740: load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\desai-all-20191223.smap ,used 122 ms
[INFO]2021-06-15 09:44:52,751: start load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\meiwei423.smap
[INFO]2021-06-15 09:44:52,817: load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\meiwei423.smap ,used 75 ms
[INFO]2021-06-15 09:44:52,828: start load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\meiwei428.smap
[INFO]2021-06-15 09:44:52,878: load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\meiwei428.smap ,used 59 ms
[INFO]2021-06-15 09:44:52,882: import agvDevice.main_agvDevice
[INFO]2021-06-15 09:44:52,883: import akmCtrl.main_akmCtrl
[INFO]2021-06-15 09:44:52,908: create lock <lock name:runTasks.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001F90ECA6120>>
[INFO]2021-06-15 09:44:52,919: create lock <lock name:agvApi.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001F90ECD8C88>>
[INFO]2021-06-15 09:44:52,949: create lock <lock name:runTasks.pre_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001F90EC09D78>>
[INFO]2021-06-15 09:44:52,951: create lock <lock name:timer.lock_2169246783248,<unlocked _thread.RLock object owner=0 count=0 at 0x000001F90EBEF440>>
[INFO]2021-06-15 09:44:52,953: create lock <lock name:mapMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001F90D4EC1C0>>
[INFO]2021-06-15 09:44:53,001: import alarm.main_alarm
[INFO]2021-06-15 09:44:53,003: import auth.main_auth
[INFO]2021-06-15 09:44:53,397: import door.main_door
[INFO]2021-06-15 09:44:53,401: import elevator.main_elevator
[INFO]2021-06-15 09:44:53,405: create lock <lock name:elevatorApi.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001F90D4ECCB0>>
[INFO]2021-06-15 09:44:53,406: import feed.main_feed
[INFO]2021-06-15 09:44:53,413: IP: 0.0.0.0 port: 10001
[INFO]2021-06-15 09:44:53,414: import remoteio.main_remoteio
[SUCC]2021-06-15 09:44:53,428: utility start, pid=16860, ppid=1876
[DEBUG]2021-06-15 09:44:53,431: start timer
[INFO]2021-06-15 09:44:53,442: load agv file: C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl/projects/test/agv.cfg
[INFO]2021-06-15 09:44:53,443: create lock <lock name:agvList.AGV30.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001F910B46440>>
[DEBUG]2021-06-15 09:44:53,449: create aliveObj AGV30 AGV离线异常 timeout 300
[INFO]2021-06-15 09:44:53,450: AGV30 start agvList run thread
[INFO]2021-06-15 09:44:53,451: AGV30 start agvList run2 thread
[DEBUG]2021-06-15 09:44:53,455: start timer
[ERROR]2021-06-15 09:44:53,458: agv check init error False
[WARNING]2021-06-15 09:44:53,465: Local server start! version 3.7.3, path C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\common, pid 16860
[INFO]2021-06-15 09:44:53,466: add_ignore: taskStatus
[INFO]2021-06-15 09:44:53,467: add_ignore: api/elevator/status
[INFO]2021-06-15 09:44:53,470: add_ignore: scada/getTask
[INFO]2021-06-15 09:44:53,974: AGV30 current map meiwei428
[INFO]2021-06-15 09:44:53,976: AGV30 is online
[INFO]2021-06-15 09:44:53,982: tcp server [0.0.0.0][10001] ,connectedLen: 1, tcp connected 192.168.252.159:10001 <--> 192.168.252.148:61800
[DEBUG]2021-06-15 09:44:54,482: GET: http://127.0.0.1:5551/api/agv/init?appName=MeiWeiTask addr: 127.0.0.1
[INFO]2021-06-15 09:44:54,485: MeiWeiTask init client agvApi
[DEBUG]2021-06-15 09:44:54,488: used 6ms 200 OK application/json;charset=utf-8, GET: http://127.0.0.1:5551/api/agv/init?appName=MeiWeiTask
[DEBUG]2021-06-15 09:44:57,566: GET: http://127.0.0.1:5551/api/agv/startCharge?appName=MeiWeiTask addr: 127.0.0.1
[DEBUG]2021-06-15 09:44:57,644: used 78ms 200 OK application/json;charset=utf-8, GET: http://127.0.0.1:5551/api/agv/startCharge?appName=MeiWeiTask
[WARNING]2021-06-15 09:44:57,735: timer_thread[tid:15652] <lock name:runTasks.g_lock,<locked _thread.RLock object owner=15652 count=1 at 0x000001F90ECA6120>> ,hold 3270 ms
[INFO]2021-06-15 09:44:57,889: name=timer_thread, pid=16860, tid=15652
[01] File "C:/Python37/lib/threading.py", line 865, in run() 
[02] File "../common/mytimer.py", line 113, in _loop() 
[03] File "../common/lock.py", line 122, in _call() 
[04] File "../common/lock.py", line 100, in release() 
[05] File "C:/Users/Administrator/Desktop/SVN/美维/MeiWei_back_0421/common/enhance.py", line 258, in getTrace() 
[06] File "C:/Users/Administrator/Desktop/SVN/美维/MeiWei_back_0421/common/enhance.py", line 240, in getThreadStack()
[INFO]2021-06-15 09:45:04,031: tcp server [0.0.0.0][10001] ,connectedLen: 1, disconnect:  192.168.252.159:10001 <--> 192.168.252.148:61800
[WARNING]2021-06-15 09:45:04,061: disconnect 192.168.252.159:10001 <--> 192.168.252.148:61800
[INFO]2021-06-15 09:45:04,248: tcp server [0.0.0.0][10001] ,connectedLen: 1, tcp connected 192.168.252.159:10001 <--> 192.168.252.148:61801
[INFO]2021-06-15 09:45:08,668: {'21': {'loc': 'Locl', 'map': 'meiwei428'}, '23': {'loc': 'Loc2', 'map': 'meiwei428'}}
[INFO]2021-06-15 09:45:08,713: 测试添加任务，起点和目的地，固化在下面的方法中
[INFO]2021-06-15 09:45:08,788: 21 0
[INFO]2021-06-15 09:45:08,851: ----------
[INFO]2021-06-15 09:45:08,899: <function g_allowNext at 0x000001F90ED2C7B8>
[INFO]2021-06-15 09:45:08,931: 21
[INFO]2021-06-15 09:45:08,994: ----------------------------------addTaskByButton-----
[INFO]2021-06-15 09:45:09,073: ----------------------scadaTask----------------
[INFO]2021-06-15 09:45:09,119: Loc8 Locl 1
[INFO]2021-06-15 09:45:09,196: unload
[INFO]2021-06-15 09:45:09,334: create task[60c80625b7bada35686c5acb]: type= scadaTask , 从Loc8运送货架到Locl {'source': 'Loc8', 'target': 'Locl', 'payloadId': '21', 'priority': 1, 'type': 'scadaTask', 'taskName': '从Loc8运送货架到Locl', 'createTime': datetime.datetime(2021, 6, 15, 9, 45, 9, 304512), 'updateTime': datetime.datetime(2021, 6, 15, 9, 45, 9, 304512), 'startTime': None, 'endTime': None, 'status': 'waiting', 'step': 'waiting', 'failMsg': None, 'history': [], '_id': ObjectId('60c80625b7bada35686c5acb')}
[INFO]2021-06-15 09:45:09,415: 60c80625b7bada35686c5acb
[WARNING]2021-06-15 09:45:09,633: task[60c80625b7bada35686c5acb]: failed, {'failMsg': "can't find target-Locl info", 'endTime': datetime.datetime(2021, 6, 15, 9, 45, 9, 601667), 'status': 'fail'}
[INFO]2021-06-15 09:45:09,738: {'prepoint': '10', 'location': '8', 'floorId': 'meiwei428', 'direction': None, 'payloadId': None, 'p_direction': 0.0, 'WorkPlace': 'true'}
[INFO]2021-06-15 09:45:09,784: task[60c80625b7bada35686c5acb]:  start {'failMsg': '任务等待执行', 'startTime': datetime.datetime(2021, 6, 15, 9, 45, 9, 768840), 'updateTime': datetime.datetime(2021, 6, 15, 9, 45, 9, 768840), 'status': 'running'}
[INFO]2021-06-15 09:45:09,892: ===========================> waiting
[INFO]2021-06-15 09:45:15,230: task[60c80625b7bada35686c5acb] update info: {'failMsg': '等待分配小车', 'updateTime': datetime.datetime(2021, 6, 15, 9, 45, 15, 215281)}
[WARNING]2021-06-15 09:45:15,294: scada.60c80625b7bada35686c5acb[tid:11076] <locked _thread.RLock object owner=11076 count=1 at 0x000001F910D200A8> ,hold 5402 ms
[INFO]2021-06-15 09:45:15,669: name=scada.60c80625b7bada35686c5acb, pid=16860, tid=11076
[01] File "C:/Python37/lib/threading.py", line 865, in run() 
[02] File "../common/utility.py", line 167, in __call() 
[03] File "C:/Users/Administrator/Desktop/SVN/美维/MeiWei_back_0421/akmCtrl/beans/scadaTaskBean.py", line 825, in _taskFunc() 
[04] File "../common/lock.py", line 122, in _call() 
[05] File "../common/lock.py", line 100, in release() 
[06] File "C:/Users/Administrator/Desktop/SVN/美维/MeiWei_back_0421/common/enhance.py", line 258, in getTrace() 
[07] File "C:/Users/Administrator/Desktop/SVN/美维/MeiWei_back_0421/common/enhance.py", line 240, in getThreadStack()
[CRITICAL]2021-06-15 09:45:15,794: invoke <function scadaTask._taskFunc at 0x000001F90D4D56A8> cause a error: 'NoneType' object is not subscriptable
pid=16860, ppid=1876, tid=11076
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\akmCtrl\beans\scadaTaskBean.py", line 830, in _taskFunc
    log.debug(str(self), old, "->", self.taskStep)
  File "C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\akmCtrl\beans\scadaTaskBean.py", line 170, in __str__
    self.taskId, a, self.s_info["location"], self.s_info["prepoint"], self.t_info["location"],self.t_info["prepoint"], self.taskStep)
TypeError: 'NoneType' object is not subscriptable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "..\common\utility.py", line 167, in __call
    return func(*p,**pp)
  File "C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\akmCtrl\beans\scadaTaskBean.py", line 836, in _taskFunc
    log.exception("taskFunc2:" + str(self), e)
  File "C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\akmCtrl\beans\scadaTaskBean.py", line 170, in __str__
    self.taskId, a, self.s_info["location"], self.s_info["prepoint"], self.t_info["location"],self.t_info["prepoint"], self.taskStep)
TypeError: 'NoneType' object is not subscriptable

[INFO]2021-06-15 09:45:19,733: tcp server [0.0.0.0][10001] ,connectedLen: 1, disconnect:  192.168.252.159:10001 <--> 192.168.252.148:61801
