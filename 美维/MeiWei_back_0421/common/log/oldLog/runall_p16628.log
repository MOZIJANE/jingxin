[INFO]2021-06-15 10:01:24,507: log files at C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\common\log
[INFO]2021-06-15 10:01:24,508: find module account.main_account
[INFO]2021-06-15 10:01:24,508: find module agvCtrl.main_agv
[INFO]2021-06-15 10:01:24,509: find module agvDevice.main_agvDevice
[INFO]2021-06-15 10:01:24,509: find module akmCtrl.main_akmCtrl
[INFO]2021-06-15 10:01:24,509: find module alarm.main_alarm
[INFO]2021-06-15 10:01:24,509: find module auth.main_auth
[INFO]2021-06-15 10:01:24,510: find module door.main_door
[INFO]2021-06-15 10:01:24,510: find module elevator.main_elevator
[INFO]2021-06-15 10:01:24,512: find module feed.main_feed
[INFO]2021-06-15 10:01:24,513: find module remoteio.main_remoteio
[INFO]2021-06-15 10:01:24,513: import account.main_account
[INFO]2021-06-15 10:01:24,592: import agvCtrl.main_agv
[INFO]2021-06-15 10:01:24,872: create lock <lock name:doorMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x0000019159DBDDA0>>
[INFO]2021-06-15 10:01:24,888: create lock <lock name:door.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x0000019159DBDF08>>
[INFO]2021-06-15 10:01:24,977: create lock <lock name:timer.lock_1723793498352,<unlocked _thread.RLock object owner=0 count=0 at 0x000001915A135B70>>
[ERROR]2021-06-15 10:01:24,992: mqtt is disabled
[INFO]2021-06-15 10:01:24,993: mqtt: subscribe [alarm/raise/+]
[INFO]2021-06-15 10:01:24,994: mqtt: subscribe [alarm/clear/+]
[INFO]2021-06-15 10:01:28,033: Mongodb connect to 127.0.0.1 port 27017
[INFO]2021-06-15 10:01:28,057: create lock <lock name:elevatorMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001915A3F8030>>
[WARNING]2021-06-15 10:01:28,066: use mockAgvCtrl
[INFO]2021-06-15 10:01:28,068: create lock <lock name:mapMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x00000191585FDC88>>
[INFO]2021-06-15 10:01:28,334: create lock <lock name:agvList.g_agvLock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001915A430F58>>
[INFO]2021-06-15 10:01:28,337: create lock <lock name:taskList.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001915A4AAFA8>>
[INFO]2021-06-15 10:01:28,402: charge policy 1 , fix time
[INFO]2021-06-15 10:01:28,434: create lock <lock name:agvApi.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001915A522198>>
[INFO]2021-06-15 10:01:29,059: start load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\AKM2F.smap
[DEBUG]2021-06-15 10:01:29,158: elevator thread start
[INFO]2021-06-15 10:01:29,178: load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\AKM2F.smap ,used 127 ms
[INFO]2021-06-15 10:01:29,188: start load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\akmsmt.smap
[INFO]2021-06-15 10:01:29,235: load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\akmsmt.smap ,used 56 ms
[INFO]2021-06-15 10:01:29,247: start load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\akmsmtMap.smap
[INFO]2021-06-15 10:01:29,372: load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\akmsmtMap.smap ,used 135 ms
[INFO]2021-06-15 10:01:29,383: start load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\desai-all-20191223.smap
[INFO]2021-06-15 10:01:29,494: load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\desai-all-20191223.smap ,used 120 ms
[INFO]2021-06-15 10:01:29,504: start load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\meiwei423.smap
[INFO]2021-06-15 10:01:29,580: load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\meiwei423.smap ,used 83 ms
[INFO]2021-06-15 10:01:29,590: start load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\meiwei428.smap
[INFO]2021-06-15 10:01:29,639: load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\meiwei428.smap ,used 58 ms
[INFO]2021-06-15 10:01:29,645: import agvDevice.main_agvDevice
[INFO]2021-06-15 10:01:29,646: import akmCtrl.main_akmCtrl
[INFO]2021-06-15 10:01:29,680: create lock <lock name:runTasks.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001915A9BA7D8>>
[INFO]2021-06-15 10:01:29,695: create lock <lock name:agvApi.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001915A9FBAA8>>
[INFO]2021-06-15 10:01:29,724: create lock <lock name:runTasks.pre_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001915A917CD8>>
[INFO]2021-06-15 10:01:29,728: create lock <lock name:timer.lock_1723874655760,<unlocked _thread.RLock object owner=0 count=0 at 0x000001915A8B6E68>>
[INFO]2021-06-15 10:01:29,730: create lock <lock name:mapMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x00000191591F9198>>
[INFO]2021-06-15 10:01:30,151: import alarm.main_alarm
[INFO]2021-06-15 10:01:30,153: import auth.main_auth
[INFO]2021-06-15 10:01:30,173: import door.main_door
[INFO]2021-06-15 10:01:30,177: import elevator.main_elevator
[INFO]2021-06-15 10:01:30,180: create lock <lock name:elevatorApi.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x00000191591F9C88>>
[INFO]2021-06-15 10:01:30,182: import feed.main_feed
[INFO]2021-06-15 10:01:30,184: IP: 0.0.0.0 port: 10001
[INFO]2021-06-15 10:01:30,186: import remoteio.main_remoteio
[SUCC]2021-06-15 10:01:30,201: utility start, pid=16628, ppid=13548
[DEBUG]2021-06-15 10:01:30,201: start timer
[INFO]2021-06-15 10:01:30,215: load agv file: C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl/projects/test/agv.cfg
[INFO]2021-06-15 10:01:30,216: create lock <lock name:agvList.AGV30.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001915B0E2670>>
[DEBUG]2021-06-15 10:01:30,218: create aliveObj AGV30 AGV离线异常 timeout 300
[INFO]2021-06-15 10:01:30,220: AGV30 start agvList run thread
[INFO]2021-06-15 10:01:30,220: AGV30 start agvList run2 thread
[ERROR]2021-06-15 10:01:30,230: agv check init error False
[DEBUG]2021-06-15 10:01:30,231: start timer
[WARNING]2021-06-15 10:01:30,237: Local server start! version 3.7.3, path C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\common, pid 16628
[INFO]2021-06-15 10:01:30,239: add_ignore: taskStatus
[INFO]2021-06-15 10:01:30,243: add_ignore: api/elevator/status
[INFO]2021-06-15 10:01:30,246: add_ignore: scada/getTask
[INFO]2021-06-15 10:01:30,734: tcp server [0.0.0.0][10001] ,connectedLen: 1, tcp connected 192.168.252.159:10001 <--> 192.168.252.148:61978
[INFO]2021-06-15 10:01:30,738: AGV30 current map meiwei428
[INFO]2021-06-15 10:01:30,739: AGV30 is online
[DEBUG]2021-06-15 10:01:31,255: GET: http://127.0.0.1:5551/api/agv/init?appName=MeiWeiTask addr: 127.0.0.1
[INFO]2021-06-15 10:01:31,258: MeiWeiTask init client agvApi
[DEBUG]2021-06-15 10:01:31,262: used 7ms 200 OK application/json;charset=utf-8, GET: http://127.0.0.1:5551/api/agv/init?appName=MeiWeiTask
[DEBUG]2021-06-15 10:01:34,368: GET: http://127.0.0.1:5551/api/agv/startCharge?appName=MeiWeiTask addr: 127.0.0.1
[DEBUG]2021-06-15 10:01:34,402: used 34ms 200 OK application/json;charset=utf-8, GET: http://127.0.0.1:5551/api/agv/startCharge?appName=MeiWeiTask
[WARNING]2021-06-15 10:01:34,617: timer_thread[tid:16160] <lock name:runTasks.g_lock,<locked _thread.RLock object owner=16160 count=1 at 0x000001915A9BA7D8>> ,hold 3379 ms
[INFO]2021-06-15 10:01:34,866: name=timer_thread, pid=16628, tid=16160
[01] File "C:/Python37/lib/threading.py", line 865, in run() 
[02] File "../common/mytimer.py", line 113, in _loop() 
[03] File "../common/lock.py", line 122, in _call() 
[04] File "../common/lock.py", line 100, in release() 
[05] File "C:/Users/Administrator/Desktop/SVN/美维/MeiWei_back_0421/common/enhance.py", line 258, in getTrace() 
[06] File "C:/Users/Administrator/Desktop/SVN/美维/MeiWei_back_0421/common/enhance.py", line 240, in getThreadStack()
[INFO]2021-06-15 10:01:40,746: tcp server [0.0.0.0][10001] ,connectedLen: 1, disconnect:  192.168.252.159:10001 <--> 192.168.252.148:61978
[WARNING]2021-06-15 10:01:40,808: disconnect 192.168.252.159:10001 <--> 192.168.252.148:61978
[INFO]2021-06-15 10:01:40,900: tcp server [0.0.0.0][10001] ,connectedLen: 2, tcp connected 192.168.252.159:10001 <--> 192.168.252.148:61979
[INFO]2021-06-15 10:01:43,839: {'21': {'loc': 'Locl', 'map': 'meiwei428'}, '23': {'loc': 'Loc2', 'map': 'meiwei428'}}
[INFO]2021-06-15 10:01:43,901: 测试添加任务，起点和目的地，固化在下面的方法中
[INFO]2021-06-15 10:01:43,963: 21 0
[INFO]2021-06-15 10:01:44,041: ----------
[INFO]2021-06-15 10:01:44,087: <function g_allowNext at 0x00000191591C4D90>
[INFO]2021-06-15 10:01:44,149: ----------------------------------addTaskByButton-----
[INFO]2021-06-15 10:01:44,212: ----------------------scadaTask----------------
[INFO]2021-06-15 10:01:44,383: Loc8 Locl 21
[INFO]2021-06-15 10:01:44,432: unload
[INFO]2021-06-15 10:01:44,509: create task[60c80a08b8f81daffb706c9f]: type= scadaTask , 从Loc8运送货架到Locl {'source': 'Loc8', 'target': 'Locl', 'payloadId': None, 'priority': 1, 'type': 'scadaTask', 'taskName': '从Loc8运送货架到Locl', 'createTime': datetime.datetime(2021, 6, 15, 10, 1, 44, 494414), 'updateTime': datetime.datetime(2021, 6, 15, 10, 1, 44, 494414), 'startTime': None, 'endTime': None, 'status': 'waiting', 'step': 'waiting', 'failMsg': None, 'history': [], '_id': ObjectId('60c80a08b8f81daffb706c9f')}
[INFO]2021-06-15 10:01:44,603: 60c80a08b8f81daffb706c9f
[WARNING]2021-06-15 10:01:44,786: task[60c80a08b8f81daffb706c9f]: failed, {'failMsg': "can't find target-Locl info", 'endTime': datetime.datetime(2021, 6, 15, 10, 1, 44, 771672), 'status': 'fail'}
[INFO]2021-06-15 10:01:44,908: {'prepoint': '10', 'location': '8', 'floorId': 'meiwei428', 'direction': None, 'payloadId': None, 'p_direction': 0.0, 'WorkPlace': 'true'}
[INFO]2021-06-15 10:01:45,015: task[60c80a08b8f81daffb706c9f]:  start {'failMsg': '任务等待执行', 'startTime': datetime.datetime(2021, 6, 15, 10, 1, 44, 970727), 'updateTime': datetime.datetime(2021, 6, 15, 10, 1, 44, 970727), 'status': 'running'}
[INFO]2021-06-15 10:01:45,075: 60c80a08b8f81daffb706c9f
[INFO]2021-06-15 10:01:45,183: 8
[INFO]2021-06-15 10:01:45,259: 10
[INFO]2021-06-15 10:01:45,384: ===========================> waiting
[INFO]2021-06-15 10:01:45,584: task[60c80a08b8f81daffb706c9f] update info: {'failMsg': '等待分配小车', 'updateTime': datetime.datetime(2021, 6, 15, 10, 1, 45, 490350)}
[INFO]2021-06-15 10:01:45,645: 60c80a08b8f81daffb706c9f
[INFO]2021-06-15 10:01:45,722: 8
[INFO]2021-06-15 10:01:45,782: 10
[INFO]2021-06-15 10:01:45,859: 60c80a08b8f81daffb706c9f
[INFO]2021-06-15 10:01:45,966: 8
[INFO]2021-06-15 10:01:47,593: 10
[CRITICAL]2021-06-15 10:01:47,761: invoke <function scadaTask._taskFunc at 0x00000191591E56A8> cause a error: 'NoneType' object is not subscriptable
pid=16628, ppid=13548, tid=14944
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\akmCtrl\beans\scadaTaskBean.py", line 836, in _taskFunc
    log.debug(str(self), old, "->", self.taskStep)
  File "C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\akmCtrl\beans\scadaTaskBean.py", line 170, in __str__
    log.info(self.t_info["location"])
TypeError: 'NoneType' object is not subscriptable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "..\common\utility.py", line 167, in __call
    return func(*p,**pp)
  File "C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\akmCtrl\beans\scadaTaskBean.py", line 842, in _taskFunc
    log.exception("taskFunc2:" + str(self), e)
  File "C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\akmCtrl\beans\scadaTaskBean.py", line 170, in __str__
    log.info(self.t_info["location"])
TypeError: 'NoneType' object is not subscriptable

[INFO]2021-06-15 10:01:54,925: tcp server [0.0.0.0][10001] ,connectedLen: 1, disconnect:  192.168.252.159:10001 <--> 192.168.252.148:61979
[WARNING]2021-06-15 10:01:54,986: disconnect 192.168.252.159:10001 <--> 192.168.252.148:61979
[INFO]2021-06-15 10:01:55,091: tcp server [0.0.0.0][10001] ,connectedLen: 1, tcp connected 192.168.252.159:10001 <--> 192.168.252.148:61980
[INFO]2021-06-15 10:02:05,177: tcp server [0.0.0.0][10001] ,connectedLen: 1, disconnect:  192.168.252.159:10001 <--> 192.168.252.148:61980
