[INFO]2021-06-15 10:23:28,567: log files at C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\common\log
[INFO]2021-06-15 10:23:28,568: find module account.main_account
[INFO]2021-06-15 10:23:28,568: find module agvCtrl.main_agv
[INFO]2021-06-15 10:23:28,569: find module agvDevice.main_agvDevice
[INFO]2021-06-15 10:23:28,569: find module akmCtrl.main_akmCtrl
[INFO]2021-06-15 10:23:28,570: find module alarm.main_alarm
[INFO]2021-06-15 10:23:28,570: find module auth.main_auth
[INFO]2021-06-15 10:23:28,570: find module door.main_door
[INFO]2021-06-15 10:23:28,570: find module elevator.main_elevator
[INFO]2021-06-15 10:23:28,571: find module feed.main_feed
[INFO]2021-06-15 10:23:28,571: find module remoteio.main_remoteio
[INFO]2021-06-15 10:23:28,571: import account.main_account
[INFO]2021-06-15 10:23:28,653: import agvCtrl.main_agv
[INFO]2021-06-15 10:23:28,940: create lock <lock name:doorMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001C5AD82EDA0>>
[INFO]2021-06-15 10:23:28,956: create lock <lock name:door.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001C5AD82EF08>>
[INFO]2021-06-15 10:23:29,051: create lock <lock name:timer.lock_1948535247424,<unlocked _thread.RLock object owner=0 count=0 at 0x000001C5ADBA5BC0>>
[ERROR]2021-06-15 10:23:29,065: mqtt is disabled
[INFO]2021-06-15 10:23:29,066: mqtt: subscribe [alarm/raise/+]
[INFO]2021-06-15 10:23:29,067: mqtt: subscribe [alarm/clear/+]
[INFO]2021-06-15 10:23:32,108: Mongodb connect to 127.0.0.1 port 27017
[INFO]2021-06-15 10:23:32,131: create lock <lock name:elevatorMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001C5ADE67080>>
[WARNING]2021-06-15 10:23:32,142: use mockAgvCtrl
[INFO]2021-06-15 10:23:32,145: create lock <lock name:mapMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001C5AC06CC88>>
[INFO]2021-06-15 10:23:32,440: create lock <lock name:agvList.g_agvLock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001C5ADF1A030>>
[INFO]2021-06-15 10:23:32,444: create lock <lock name:taskList.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001C5ADF1AF58>>
[INFO]2021-06-15 10:23:32,504: charge policy 1 , fix time
[INFO]2021-06-15 10:23:32,537: create lock <lock name:agvApi.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001C5ADF92080>>
[INFO]2021-06-15 10:23:33,174: start load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\AKM2F.smap
[DEBUG]2021-06-15 10:23:33,277: elevator thread start
[INFO]2021-06-15 10:23:33,297: load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\AKM2F.smap ,used 132 ms
[INFO]2021-06-15 10:23:33,307: start load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\akmsmt.smap
[INFO]2021-06-15 10:23:33,351: load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\akmsmt.smap ,used 53 ms
[INFO]2021-06-15 10:23:33,366: start load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\akmsmtMap.smap
[INFO]2021-06-15 10:23:33,486: load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\akmsmtMap.smap ,used 129 ms
[INFO]2021-06-15 10:23:33,497: start load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\desai-all-20191223.smap
[INFO]2021-06-15 10:23:33,609: load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\desai-all-20191223.smap ,used 121 ms
[INFO]2021-06-15 10:23:33,619: start load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\meiwei423.smap
[INFO]2021-06-15 10:23:33,686: load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\meiwei423.smap ,used 75 ms
[INFO]2021-06-15 10:23:33,696: start load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\meiwei428.smap
[INFO]2021-06-15 10:23:33,746: load map C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl\projects\test\meiwei428.smap ,used 58 ms
[INFO]2021-06-15 10:23:33,750: import agvDevice.main_agvDevice
[INFO]2021-06-15 10:23:33,751: import akmCtrl.main_akmCtrl
[INFO]2021-06-15 10:23:33,786: create lock <lock name:runTasks.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001C5AE41C990>>
[INFO]2021-06-15 10:23:33,803: create lock <lock name:agvApi.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001C5AE45DD50>>
[INFO]2021-06-15 10:23:33,830: create lock <lock name:runTasks.pre_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001C5AE378FD0>>
[INFO]2021-06-15 10:23:33,831: create lock <lock name:timer.lock_1948579614792,<unlocked _thread.RLock object owner=0 count=0 at 0x000001C5AE372350>>
[INFO]2021-06-15 10:23:33,835: create lock <lock name:mapMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001C5ACC66210>>
[INFO]2021-06-15 10:23:34,271: import alarm.main_alarm
[INFO]2021-06-15 10:23:34,280: import auth.main_auth
[INFO]2021-06-15 10:23:34,297: import door.main_door
[INFO]2021-06-15 10:23:34,299: import elevator.main_elevator
[INFO]2021-06-15 10:23:34,304: create lock <lock name:elevatorApi.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001C5ACC66D00>>
[INFO]2021-06-15 10:23:34,306: import feed.main_feed
[INFO]2021-06-15 10:23:34,313: IP: 0.0.0.0 port: 10001
[INFO]2021-06-15 10:23:34,315: import remoteio.main_remoteio
[SUCC]2021-06-15 10:23:34,330: utility start, pid=15592, ppid=9236
[DEBUG]2021-06-15 10:23:34,336: start timer
[INFO]2021-06-15 10:23:34,346: load agv file: C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\agvCtrl/projects/test/agv.cfg
[INFO]2021-06-15 10:23:34,347: create lock <lock name:agvList.AGV30.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x000001C5AEC554B8>>
[DEBUG]2021-06-15 10:23:34,352: create aliveObj AGV30 AGV离线异常 timeout 300
[INFO]2021-06-15 10:23:34,353: AGV30 start agvList run thread
[INFO]2021-06-15 10:23:34,354: AGV30 start agvList run2 thread
[DEBUG]2021-06-15 10:23:34,360: start timer
[ERROR]2021-06-15 10:23:34,364: agv check init error False
[WARNING]2021-06-15 10:23:34,369: Local server start! version 3.7.3, path C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\common, pid 15592
[INFO]2021-06-15 10:23:34,374: add_ignore: taskStatus
[INFO]2021-06-15 10:23:34,375: add_ignore: api/elevator/status
[INFO]2021-06-15 10:23:34,378: add_ignore: scada/getTask
[INFO]2021-06-15 10:23:34,876: AGV30 current map meiwei428
[INFO]2021-06-15 10:23:34,878: AGV30 is online
[INFO]2021-06-15 10:23:35,187: tcp server [0.0.0.0][10001] ,connectedLen: 1, tcp connected 192.168.252.159:10001 <--> 192.168.252.148:62011
[DEBUG]2021-06-15 10:23:35,387: GET: http://127.0.0.1:5551/api/agv/init?appName=MeiWeiTask addr: 127.0.0.1
[INFO]2021-06-15 10:23:35,389: MeiWeiTask init client agvApi
[DEBUG]2021-06-15 10:23:35,390: used 3ms 200 OK application/json;charset=utf-8, GET: http://127.0.0.1:5551/api/agv/init?appName=MeiWeiTask
[DEBUG]2021-06-15 10:23:38,665: GET: http://127.0.0.1:5551/api/agv/startCharge?appName=MeiWeiTask addr: 127.0.0.1
[DEBUG]2021-06-15 10:23:38,822: used 157ms 200 OK application/json;charset=utf-8, GET: http://127.0.0.1:5551/api/agv/startCharge?appName=MeiWeiTask
[WARNING]2021-06-15 10:23:38,994: timer_thread[tid:5700] <lock name:runTasks.g_lock,<locked _thread.RLock object owner=5700 count=1 at 0x000001C5AE41C990>> ,hold 3623 ms
[INFO]2021-06-15 10:23:39,325: name=timer_thread, pid=15592, tid=5700
[01] File "C:/Python37/lib/threading.py", line 865, in run() 
[02] File "../common/mytimer.py", line 113, in _loop() 
[03] File "../common/lock.py", line 122, in _call() 
[04] File "../common/lock.py", line 100, in release() 
[05] File "C:/Users/Administrator/Desktop/SVN/美维/MeiWei_back_0421/common/enhance.py", line 258, in getTrace() 
[06] File "C:/Users/Administrator/Desktop/SVN/美维/MeiWei_back_0421/common/enhance.py", line 240, in getThreadStack()
[INFO]2021-06-15 10:23:45,271: tcp server [0.0.0.0][10001] ,connectedLen: 1, disconnect:  192.168.252.159:10001 <--> 192.168.252.148:62011
[WARNING]2021-06-15 10:23:45,366: disconnect 192.168.252.159:10001 <--> 192.168.252.148:62011
[INFO]2021-06-15 10:23:45,536: tcp server [0.0.0.0][10001] ,connectedLen: 1, tcp connected 192.168.252.159:10001 <--> 192.168.252.148:62012
[INFO]2021-06-15 10:23:55,672: tcp server [0.0.0.0][10001] ,connectedLen: 1, disconnect:  192.168.252.159:10001 <--> 192.168.252.148:62012
[WARNING]2021-06-15 10:23:55,767: disconnect 192.168.252.159:10001 <--> 192.168.252.148:62012
[INFO]2021-06-15 10:23:55,889: tcp server [0.0.0.0][10001] ,connectedLen: 1, tcp connected 192.168.252.159:10001 <--> 192.168.252.148:62013
[INFO]2021-06-15 10:23:59,931: {'21': {'loc': 'Locl', 'map': 'meiwei428'}, '23': {'loc': 'Loc2', 'map': 'meiwei428'}}
[INFO]2021-06-15 10:23:59,977: 测试添加任务，起点和目的地，固化在下面的方法中
[INFO]2021-06-15 10:24:00,102: Locl
[INFO]2021-06-15 10:24:00,146: Locl
[INFO]2021-06-15 10:24:00,208: ----------------------------------addTaskByButton-----
[INFO]2021-06-15 10:24:00,315: ----------------------scadaTask----------------
[INFO]2021-06-15 10:24:00,361: Loc8 Locl 21
[INFO]2021-06-15 10:24:00,439: unload
[INFO]2021-06-15 10:24:00,610: create task[60c80f4031108690b7c549b2]: type= scadaTask , 从Loc8运送货架到Locl {'source': 'Loc8', 'target': 'Locl', 'payloadId': None, 'priority': 1, 'type': 'scadaTask', 'taskName': '从Loc8运送货架到Locl', 'createTime': datetime.datetime(2021, 6, 15, 10, 24, 0, 501386), 'updateTime': datetime.datetime(2021, 6, 15, 10, 24, 0, 501386), 'startTime': None, 'endTime': None, 'status': 'waiting', 'step': 'waiting', 'failMsg': None, 'history': [], '_id': ObjectId('60c80f4031108690b7c549b2')}
[INFO]2021-06-15 10:24:00,670: 60c80f4031108690b7c549b2
[WARNING]2021-06-15 10:24:00,891: task[60c80f4031108690b7c549b2]: failed, {'failMsg': "can't find target-Locl info", 'endTime': datetime.datetime(2021, 6, 15, 10, 24, 0, 860438), 'status': 'fail'}
[INFO]2021-06-15 10:24:00,985: {'prepoint': '10', 'location': '8', 'floorId': 'meiwei428', 'direction': None, 'payloadId': None, 'p_direction': 0.0, 'WorkPlace': 'true'}
[INFO]2021-06-15 10:24:01,078: task[60c80f4031108690b7c549b2]:  start {'failMsg': '任务等待执行', 'startTime': datetime.datetime(2021, 6, 15, 10, 24, 1, 63498), 'updateTime': datetime.datetime(2021, 6, 15, 10, 24, 1, 63498), 'status': 'running'}
[INFO]2021-06-15 10:24:01,155: taskid 60c80f4031108690b7c549b2
[INFO]2021-06-15 10:24:01,215: s_loc 8
[INFO]2021-06-15 10:24:01,276: s_pre 10
[INFO]2021-06-15 10:24:01,368: ===========================> waiting
[INFO]2021-06-15 10:24:01,459: task[60c80f4031108690b7c549b2] update info: {'failMsg': '等待分配小车', 'updateTime': datetime.datetime(2021, 6, 15, 10, 24, 1, 444472)}
[INFO]2021-06-15 10:24:01,522: taskid 60c80f4031108690b7c549b2
[INFO]2021-06-15 10:24:01,614: s_loc 8
[INFO]2021-06-15 10:24:01,688: s_pre 10
[INFO]2021-06-15 10:24:01,750: taskid 60c80f4031108690b7c549b2
[INFO]2021-06-15 10:24:01,810: s_loc 8
[INFO]2021-06-15 10:24:01,872: s_pre 10
[CRITICAL]2021-06-15 10:24:01,981: invoke <function scadaTask._taskFunc at 0x000001C5ACC536A8> cause a error: 'NoneType' object is not subscriptable
pid=15592, ppid=9236, tid=16988
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\akmCtrl\beans\scadaTaskBean.py", line 836, in _taskFunc
    log.debug(str(self), old, "->", self.taskStep)
  File "C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\akmCtrl\beans\scadaTaskBean.py", line 170, in __str__
    log.info('t_loc',self.t_info["location"])
TypeError: 'NoneType' object is not subscriptable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "..\common\utility.py", line 167, in __call
    return func(*p,**pp)
  File "C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\akmCtrl\beans\scadaTaskBean.py", line 842, in _taskFunc
    log.exception("taskFunc2:" + str(self), e)
  File "C:\Users\Administrator\Desktop\SVN\美维\MeiWei_back_0421\akmCtrl\beans\scadaTaskBean.py", line 170, in __str__
    log.info('t_loc',self.t_info["location"])
TypeError: 'NoneType' object is not subscriptable

[INFO]2021-06-15 10:24:10,991: tcp server [0.0.0.0][10001] ,connectedLen: 1, disconnect:  192.168.252.159:10001 <--> 192.168.252.148:62013
