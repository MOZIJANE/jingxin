[INFO]2021-04-26 15:50:32,394: log files at E:\projects_by_myself\backup\MeiWei_back_0421\common\log
[INFO]2021-04-26 15:50:32,396: find module account.main_account
[INFO]2021-04-26 15:50:32,397: find module agvCtrl.main_agv
[INFO]2021-04-26 15:50:32,398: find module agvDevice.main_agvDevice
[INFO]2021-04-26 15:50:32,400: find module akmCtrl.main_akmCtrl
[INFO]2021-04-26 15:50:32,401: find module alarm.main_alarm
[INFO]2021-04-26 15:50:32,403: find module auth.main_auth
[INFO]2021-04-26 15:50:32,404: find module door.main_door
[INFO]2021-04-26 15:50:32,405: find module elevator.main_elevator
[INFO]2021-04-26 15:50:32,411: find module feed.main_feed
[INFO]2021-04-26 15:50:32,413: find module remoteio.main_remoteio
[INFO]2021-04-26 15:50:32,413: import account.main_account
[INFO]2021-04-26 15:50:32,501: import agvCtrl.main_agv
[INFO]2021-04-26 15:50:33,365: create lock <lock name:doorMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x00000203D4EC6EA0>>
[INFO]2021-04-26 15:50:34,228: create lock <lock name:door.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x00000203D4F10420>>
[INFO]2021-04-26 15:50:34,341: create lock <lock name:timer.lock_2215487181392,<unlocked _thread.RLock object owner=0 count=0 at 0x00000203D55393C0>>
[ERROR]2021-04-26 15:50:34,352: mqtt is disabled
[INFO]2021-04-26 15:50:34,354: mqtt: subscribe [alarm/raise/+]
[INFO]2021-04-26 15:50:34,356: mqtt: subscribe [alarm/clear/+]
[INFO]2021-04-26 15:50:37,389: Mongodb connect to 127.0.0.1 port 27017
[INFO]2021-04-26 15:50:37,415: create lock <lock name:elevatorMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x00000203D5749DB0>>
[WARNING]2021-04-26 15:50:37,423: use mockAgvCtrl
[INFO]2021-04-26 15:50:37,425: create lock <lock name:mapMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x00000203D37A4360>>
[INFO]2021-04-26 15:50:37,809: create lock <lock name:agvList.g_agvLock,<unlocked _thread.RLock object owner=0 count=0 at 0x00000203D57B4E10>>
[INFO]2021-04-26 15:50:37,812: create lock <lock name:taskList.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x00000203D58119F0>>
[INFO]2021-04-26 15:50:37,884: charge policy 1 , fix time
[INFO]2021-04-26 15:50:37,950: create lock <lock name:agvApi.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x00000203D5811F00>>
[INFO]2021-04-26 15:50:38,497: start load map E:\projects_by_myself\backup\MeiWei_back_0421\agvCtrl\projects\test\AKM2F.smap
[DEBUG]2021-04-26 15:50:38,627: elevator thread start
[INFO]2021-04-26 15:50:38,654: load map E:\projects_by_myself\backup\MeiWei_back_0421\agvCtrl\projects\test\AKM2F.smap ,used 166 ms
[INFO]2021-04-26 15:50:38,664: start load map E:\projects_by_myself\backup\MeiWei_back_0421\agvCtrl\projects\test\akmsmt.smap
[INFO]2021-04-26 15:50:38,717: load map E:\projects_by_myself\backup\MeiWei_back_0421\agvCtrl\projects\test\akmsmt.smap ,used 62 ms
[INFO]2021-04-26 15:50:38,728: start load map E:\projects_by_myself\backup\MeiWei_back_0421\agvCtrl\projects\test\akmsmtMap.smap
[INFO]2021-04-26 15:50:38,877: load map E:\projects_by_myself\backup\MeiWei_back_0421\agvCtrl\projects\test\akmsmtMap.smap ,used 158 ms
[INFO]2021-04-26 15:50:38,887: start load map E:\projects_by_myself\backup\MeiWei_back_0421\agvCtrl\projects\test\desai-all-20191223.smap
[INFO]2021-04-26 15:50:39,033: load map E:\projects_by_myself\backup\MeiWei_back_0421\agvCtrl\projects\test\desai-all-20191223.smap ,used 154 ms
[INFO]2021-04-26 15:50:39,044: start load map E:\projects_by_myself\backup\MeiWei_back_0421\agvCtrl\projects\test\meiwei423.smap
[INFO]2021-04-26 15:50:39,106: load map E:\projects_by_myself\backup\MeiWei_back_0421\agvCtrl\projects\test\meiwei423.smap ,used 71 ms
[INFO]2021-04-26 15:50:39,118: start load map E:\projects_by_myself\backup\MeiWei_back_0421\agvCtrl\projects\test\untitled_20210420032952.smap
[INFO]2021-04-26 15:50:39,162: load map E:\projects_by_myself\backup\MeiWei_back_0421\agvCtrl\projects\test\untitled_20210420032952.smap ,used 54 ms
[INFO]2021-04-26 15:50:39,167: import agvDevice.main_agvDevice
[INFO]2021-04-26 15:50:39,170: import akmCtrl.main_akmCtrl
[INFO]2021-04-26 15:50:39,199: create lock <lock name:runTasks.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x00000203D5ACDD20>>
[INFO]2021-04-26 15:50:39,214: create lock <lock name:agvApi.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x00000203D6C25450>>
[INFO]2021-04-26 15:50:39,232: create lock <lock name:runTasks.pre_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x00000203D5AB3E70>>
[INFO]2021-04-26 15:50:39,234: create lock <lock name:timer.lock_2215492823264,<unlocked _thread.RLock object owner=0 count=0 at 0x00000203D5A9A5D0>>
[INFO]2021-04-26 15:50:39,236: create lock <lock name:mapMgr.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x00000203D42E3BD0>>
[INFO]2021-04-26 15:50:39,838: import alarm.main_alarm
[INFO]2021-04-26 15:50:39,839: import auth.main_auth
[INFO]2021-04-26 15:50:39,850: import door.main_door
[INFO]2021-04-26 15:50:39,853: import elevator.main_elevator
[INFO]2021-04-26 15:50:39,857: create lock <lock name:elevatorApi.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x00000203D8039F90>>
[INFO]2021-04-26 15:50:39,858: import feed.main_feed
[INFO]2021-04-26 15:50:39,868: create lock <lock name:feedTask.g_lock,<unlocked _thread.RLock object owner=0 count=0 at 0x00000203D8047C30>>
[INFO]2021-04-26 15:50:39,923: import remoteio.main_remoteio
[SUCC]2021-04-26 15:50:39,935: utility start, pid=11492, ppid=4424
[DEBUG]2021-04-26 15:50:39,936: start timer
[INFO]2021-04-26 15:50:39,945: load agv file: E:\projects_by_myself\backup\MeiWei_back_0421\agvCtrl/projects/test/agv.cfg
[INFO]2021-04-26 15:50:39,946: create lock <lock name:agvList.AGV30.lock,<unlocked _thread.RLock object owner=0 count=0 at 0x00000203D8069D20>>
[DEBUG]2021-04-26 15:50:39,949: create aliveObj AGV30 AGV离线异常 timeout 300
[INFO]2021-04-26 15:50:39,950: AGV30 start agvList run thread
[INFO]2021-04-26 15:50:39,950: AGV30 start agvList run2 thread
[ERROR]2021-04-26 15:50:39,958: agv check init error False
[DEBUG]2021-04-26 15:50:39,960: start timer
[INFO]2021-04-26 15:50:39,966: add_ignore: taskStatus
[INFO]2021-04-26 15:50:39,968: add_ignore: api/elevator/status
[INFO]2021-04-26 15:50:39,969: add_ignore: scada/getTask
[INFO]2021-04-26 15:50:40,476: AGV30 current map meiwei423
[INFO]2021-04-26 15:50:40,480: AGV30 is online
[DEBUG]2021-04-26 15:50:40,991: GET: http://127.0.0.1:5551/api/agv/init?appName=MeiWeiTask addr: 127.0.0.1
[INFO]2021-04-26 15:50:40,993: MeiWeiTask init client agvApi
[DEBUG]2021-04-26 15:50:40,996: used 5ms 200 OK application/json;charset=utf-8, GET: http://127.0.0.1:5551/api/agv/init?appName=MeiWeiTask
[DEBUG]2021-04-26 15:50:44,264: GET: http://127.0.0.1:5551/api/agv/startCharge?appName=MeiWeiTask addr: 127.0.0.1
[DEBUG]2021-04-26 15:50:44,343: used 79ms 200 OK application/json;charset=utf-8, GET: http://127.0.0.1:5551/api/agv/startCharge?appName=MeiWeiTask
[WARNING]2021-04-26 15:50:44,469: timer_thread[tid:13392] <lock name:runTasks.g_lock,<locked _thread.RLock object owner=13392 count=1 at 0x00000203D5ACDD20>> ,hold 3494 ms
[INFO]2021-04-26 15:50:44,788: name=timer_thread, pid=11492, tid=13392
[01] File "E:/Users/Administrator/AppData/Local/Programs/Python/Python38/lib/threading.py", line 870, in run() 
[02] File "../common/mytimer.py", line 113, in _loop() 
[03] File "../common/lock.py", line 122, in _call() 
[04] File "../common/lock.py", line 100, in release() 
[05] File "E:/projects_by_myself/backup/MeiWei_back_0421/common/enhance.py", line 258, in getTrace() 
[06] File "E:/projects_by_myself/backup/MeiWei_back_0421/common/enhance.py", line 240, in getThreadStack()
[DEBUG]2021-04-26 15:50:58,591: GET: http://127.0.0.1:5551/api/scada/addTaskByPad?source=MeiWeiSource&target=MeiWeiTarget addr: 127.0.0.1
[INFO]2021-04-26 15:50:59,002: create task[608670e23ea87b6a144dff3c]: type= scadaTask , 从MeiWeiSource运送货架到MeiWeiTarget {'source': 'MeiWeiSource', 'target': 'MeiWeiTarget', 'payloadId': None, 'priority': 1, 'type': 'scadaTask', 'taskName': '从MeiWeiSource运送货架到MeiWeiTarget', 'createTime': datetime.datetime(2021, 4, 26, 15, 50, 58, 922703), 'updateTime': datetime.datetime(2021, 4, 26, 15, 50, 58, 922703), 'startTime': None, 'endTime': None, 'status': 'waiting', 'step': 'waiting', 'failMsg': None, 'history': [], '_id': ObjectId('608670e23ea87b6a144dff3c')}
[DEBUG]2021-04-26 15:50:59,363: used 772ms 200 OK application/json;charset=utf-8, GET: http://127.0.0.1:5551/api/scada/addTaskByPad?source=MeiWeiSource&target=MeiWeiTarget
[INFO]2021-04-26 15:50:59,693: task[608670e23ea87b6a144dff3c]:  start {'failMsg': '任务等待执行', 'startTime': datetime.datetime(2021, 4, 26, 15, 50, 59, 646766), 'updateTime': datetime.datetime(2021, 4, 26, 15, 50, 59, 646766), 'status': 'running'}
[INFO]2021-04-26 15:50:59,946: task: start task[608670e23ea87b6a144dff3c][-] 6(1) -> 7(8) [waiting]
[INFO]2021-04-26 15:51:00,184: task[608670e23ea87b6a144dff3c] update info: {'failMsg': '等待分配小车', 'updateTime': datetime.datetime(2021, 4, 26, 15, 51, 0, 152415)}
[DEBUG]2021-04-26 15:51:01,717: task[608670e23ea87b6a144dff3c][-] 6(1) -> 7(8) [waitForAgv] waiting -> waitForAgv
[INFO]2021-04-26 15:51:02,773: ******************url********************: http://127.0.0.1:5551
[DEBUG]2021-04-26 15:51:03,038: GET: http://127.0.0.1:5551/api/agv/apply?appName=MeiWeiTask&autoLock=False&exclude&loc=1&mapId=meiwei423&taskId=608670e23ea87b6a144dff3c&timeout=10 addr: 127.0.0.1
[INFO]2021-04-26 15:51:03,204: apply AGV30 ,taskId: 608670e23ea87b6a144dff3c ,loc meiwei423.1 ,autoLock False , used 70 ms
[DEBUG]2021-04-26 15:51:03,314: used 276ms 200 OK application/json;charset=utf-8, GET: http://127.0.0.1:5551/api/agv/apply?appName=MeiWeiTask&autoLock=False&exclude&loc=1&mapId=meiwei423&taskId=608670e23ea87b6a144dff3c&timeout=10
[DEBUG]2021-04-26 15:51:03,408: GET: http://127.0.0.1:5551/api/agv/lock?agv=AGV30&appName=MeiWeiTask&taskId=608670e23ea87b6a144dff3c addr: 127.0.0.1
[DEBUG]2021-04-26 15:51:03,512: lock:  AGV30 taskId 608670e23ea87b6a144dff3c app MeiWeiTask
[WARNING]2021-04-26 15:51:04,634: AGV30 clear task finish, cur= meiwei423.9 task_status= 0
[DEBUG]2021-04-26 15:51:04,822: used 1414ms 200 OK application/json;charset=utf-8, GET: http://127.0.0.1:5551/api/agv/lock?agv=AGV30&appName=MeiWeiTask&taskId=608670e23ea87b6a144dff3c
[INFO]2021-04-26 15:51:04,949: task[608670e23ea87b6a144dff3c][-] 6(1) -> 7(8) [waitForAgv] apply AGV30
[INFO]2021-04-26 15:51:05,028: task[608670e23ea87b6a144dff3c] update info: {'agvId': 'AGV30', 'failMsg': '成功分配小车AGV30,检测顶升下降', 'updateTime': datetime.datetime(2021, 4, 26, 15, 51, 5, 12418)}
[DEBUG]2021-04-26 15:51:05,108: task[608670e23ea87b6a144dff3c][AGV30] 6(1) -> 7(8) [initJackdown] waitForAgv -> initJackdown
[INFO]2021-04-26 15:51:05,538: task[608670e23ea87b6a144dff3c][AGV30] 6(1) -> 7(8) [initJackdown] _jackDown
[INFO]2021-04-26 15:51:05,681: ************run jackDownOld********************
[INFO]2021-04-26 15:51:06,862: task[608670e23ea87b6a144dff3c] update info: {'failMsg': '前往MeiWeiSource工位点拉取货架', 'updateTime': datetime.datetime(2021, 4, 26, 15, 51, 6, 766515)}
[DEBUG]2021-04-26 15:51:06,941: task[608670e23ea87b6a144dff3c][AGV30] 6(1) -> 7(8) [moveToPreSrc] initJackdown -> moveToPreSrc
[INFO]2021-04-26 15:51:07,547: ***************调用move方法
[DEBUG]2021-04-26 15:51:07,646: GET: http://127.0.0.1:5551/api/agv/move?WorkPlace=None&agv=AGV30&agvId=AGV30&appName=MeiWeiTask&floorId=meiwei423&isRotate&loc=meiwei423.1&location=1&taskId=608670e23ea87b6a144dff3c_2&taskType=scadaTask&timeoutSec=86400 addr: 127.0.0.1
[INFO]2021-04-26 15:51:07,662: Begin: AGV30 move from meiwei423.9 to meiwei423.1 by paths: [('meiwei423', ['9', '7', '8', '6', '1'], 26.065498026668134)] task: 608670e23ea87b6a144dff3c_2 timeout 86400 used 8 ms
[INFO]2021-04-26 15:51:07,664: 移动到source的前置点 1
[DEBUG]2021-04-26 15:51:07,665: task[608670e23ea87b6a144dff3c][AGV30] 6(1) -> 7(8) [moveToPreSrc_onfinish] moveToPreSrc -> moveToPreSrc_onfinish
[WARNING]2021-04-26 15:51:08,469: AGV30 clear task,taskId= 608670e23ea87b6a144dff3c_2 map= meiwei423 paths= 9,7,8,6,1 task_status= 0
[WARNING]2021-04-26 15:51:09,478: AGV30 clear task finish, cur= meiwei423.9 task_status= 0
[CRITICAL]2021-04-26 15:51:09,487: agv thread cause a error: check() got an unexpected keyword argument 'blockPath'
pid=11492, ppid=4424, tid=4340
Traceback (most recent call last):
  File "E:\projects_by_myself\backup\MeiWei_back_0421\agvCtrl\agvList.py", line 624, in handle
    ret = obj.callback(obj.params)
  File "E:\projects_by_myself\backup\MeiWei_back_0421\agvCtrl\agvControl.py", line 637, in oncheck
    if not checkAgv(agvInfo.curTarget,paths[-1]):
  File "E:\projects_by_myself\backup\MeiWei_back_0421\common\lock.py", line 120, in _call
    return func(*p,**pp)
  File "E:\projects_by_myself\backup\MeiWei_back_0421\agvCtrl\agvControl.py", line 407, in checkAgv
    if not agvElement.check(mapMgr.getAgvList(agvElement.mapId),blockPath=None):
TypeError: check() got an unexpected keyword argument 'blockPath'

[ERROR]2021-04-26 15:51:09,489: AGV30 failed to arrived meiwei423.1 ,task: 608670e23ea87b6a144dff3c_2 error check() got an unexpected keyword argument 'blockPath'
[INFO]2021-04-26 15:51:09,686: task: move finish callback task[608670e23ea87b6a144dff3c][AGV30] 6(1) -> 7(8) [moveToPreSrc_onfinish]
[WARNING]2021-04-26 15:51:09,689: task[608670e23ea87b6a144dff3c]:  error {'failMsg': "check() got an unexpected keyword argument 'blockPath'", 'endTime': datetime.datetime(2021, 4, 26, 15, 51, 9, 687089), 'status': 'error'}
[INFO]2021-04-26 15:51:09,851: task[608670e23ea87b6a144dff3c][AGV30] 6(1) -> 7(8) [moveToPreSrc_onfinish] AGV30 release task, release agv True True False
[DEBUG]2021-04-26 15:51:09,854: GET: http://127.0.0.1:5551/api/agv/isLocked?agv=AGV30&appName=MeiWeiTask&taskId=608670e23ea87b6a144dff3c addr: 127.0.0.1
[DEBUG]2021-04-26 15:51:09,855: used 1ms 200 OK application/json;charset=utf-8, GET: http://127.0.0.1:5551/api/agv/isLocked?agv=AGV30&appName=MeiWeiTask&taskId=608670e23ea87b6a144dff3c
[DEBUG]2021-04-26 15:51:09,883: GET: http://127.0.0.1:5551/api/agv/release?agv=AGV30&appName=MeiWeiTask&force=False&taskId=608670e23ea87b6a144dff3c addr: 127.0.0.1
[DEBUG]2021-04-26 15:51:09,886: unlock: AGV30 taskId 608670e23ea87b6a144dff3c app MeiWeiTask force False
[DEBUG]2021-04-26 15:51:09,887: used 4ms 200 OK application/json;charset=utf-8, GET: http://127.0.0.1:5551/api/agv/release?agv=AGV30&appName=MeiWeiTask&force=False&taskId=608670e23ea87b6a144dff3c
[INFO]2021-04-26 15:51:09,889: task[608670e23ea87b6a144dff3c][AGV30] 6(1) -> 7(8) [moveToPreSrc_onfinish] let AGV30 gohome
[DEBUG]2021-04-26 15:51:09,892: GET: http://127.0.0.1:5551/api/agv/goHome?agv=AGV30&appName=MeiWeiTask&force=False&timeout=10800 addr: 127.0.0.1
[INFO]2021-04-26 15:51:09,894: AGV30 is in home loc meiwei423.9
[DEBUG]2021-04-26 15:51:09,906: used 14ms 200 OK application/json;charset=utf-8, GET: http://127.0.0.1:5551/api/agv/goHome?agv=AGV30&appName=MeiWeiTask&force=False&timeout=10800
[INFO]2021-04-26 15:51:09,908: task: stop task[608670e23ea87b6a144dff3c][-] 6(1) -> 7(8) [moveToPreSrc_onfinish]
[ERROR]2021-04-26 15:51:46,542: user press Ctrl+C, system quit!
[WARNING]2021-04-26 15:51:46,622: runTask:stop save file
[ERROR]2021-04-26 15:51:46,700: user press Ctrl+C, system quit!
[ERROR]2021-04-26 15:51:46,764: process exited, living 0:01:07.582401 seconds
